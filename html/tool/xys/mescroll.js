/*! mescroll -- 精致的下拉刷新和上拉加载js框架  ( a great JS framework for pull-refresh and pull-up-loading )
 * version 1.4.1
 * 2019-2-1
 * author: wenju < mescroll@qq.com > 文举
 * *
 * 官网:  http://www.mescroll.com
 * 动态:  https://github.com/mescroll/mescroll/releases
 * 问答:  http://www.mescroll.com/qa.html
 * issues:  https://github.com/mescroll/mescroll/issues
 * QQ交流群: 633126761
 */
(function(name,definition){if(typeof define==="function"){define(definition)}else{if(typeof module!=="undefined"&&module.exports){module.exports=definition()}else{this[name]=definition()}}})("MeScroll",function(){var MeScroll=function(mescrollId,options){var me=this;me.version="1.4.0";me.isScrollBody=(!mescrollId||mescrollId==="body");me.scrollDom=me.isScrollBody?document.body:me.getDomById(mescrollId);if(!me.scrollDom){return}me.options=options||{};var u=navigator.userAgent;var isIOS=!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);var isPC=typeof window.orientation==="undefined";var isAndroid=u.indexOf("Android")>-1||u.indexOf("Adr")>-1;me.os={ios:isIOS,pc:isPC,android:isAndroid};me.isDownScrolling=false;me.isUpScrolling=false;var hasDownCallback=me.options.down&&me.options.down.callback;me.initDownScroll();me.initUpScroll();setTimeout(function(){if(me.optDown.use&&me.optDown.auto&&hasDownCallback){if(me.optDown.autoShowLoading){me.triggerDownScroll()}else{me.optDown.callback&&me.optDown.callback(me)}}me.optUp.use&&me.optUp.auto&&!me.isUpAutoLoad&&me.triggerUpScroll()},30)};MeScroll.prototype.extendDownScroll=function(optDown){MeScroll.extend(optDown,{use:true,auto:true,autoShowLoading:false,isLock:false,isBoth:false,offset:80,inOffsetRate:1,outOffsetRate:0.2,bottomOffset:20,minAngle:45,hardwareClass:"mescroll-hardware",mustToTop:false,warpId:null,warpClass:"mescroll-downwarp",resetClass:"mescroll-downwarp-reset",textInOffset:"下拉刷新",textOutOffset:"释放更新",textLoading:"加载中 ...",htmlContent:'<p class="downwarp-progress"></p><p class="downwarp-tip"></p>',inited:function(mescroll,downwarp){mescroll.downTipDom=downwarp.getElementsByClassName("downwarp-tip")[0];mescroll.downProgressDom=downwarp.getElementsByClassName("downwarp-progress")[0]},inOffset:function(mescroll){if(mescroll.downTipDom){mescroll.downTipDom.innerHTML=mescroll.optDown.textInOffset}if(mescroll.downProgressDom){mescroll.downProgressDom.classList.remove("mescroll-rotate")}},outOffset:function(mescroll){if(mescroll.downTipDom){mescroll.downTipDom.innerHTML=mescroll.optDown.textOutOffset}},onMoving:function(mescroll,rate,downHight){if(mescroll.downProgressDom){var progress=360*rate;mescroll.downProgressDom.style.webkitTransform="rotate("+progress+"deg)";mescroll.downProgressDom.style.transform="rotate("+progress+"deg)"}},beforeLoading:function(mescroll,downwarp){return false},showLoading:function(mescroll){if(mescroll.downTipDom){mescroll.downTipDom.innerHTML=mescroll.optDown.textLoading}if(mescroll.downProgressDom){mescroll.downProgressDom.classList.add("mescroll-rotate")}},afterLoading:function(mescroll){return 0},callback:function(mescroll){mescroll.resetUpScroll()}})};MeScroll.prototype.extendUpScroll=function(optUp){var isPC=this.os.pc;MeScroll.extend(optUp,{use:true,auto:true,isLock:false,isBoth:false,isBounce:true,callback:null,page:{num:0,size:10,time:null},noMoreSize:5,offset:100,toTop:{warpId:null,src:null,html:null,offset:1000,warpClass:"mescroll-totop",showClass:"mescroll-fade-in",hideClass:"mescroll-fade-out",fadeDuration:0.5,duration:300,supportTap:false,btnClick:null},loadFull:{use:false,delay:500},empty:{warpId:null,icon:null,tip:"暂无相关数据~",btntext:"",btnClick:null,supportTap:false},clearId:null,clearEmptyId:null,hardwareClass:"mescroll-hardware",warpId:null,warpClass:"mescroll-upwarp",htmlLoading:'<p class="upwarp-progress mescroll-rotate"></p><p class="upwarp-tip">加载中..</p>',htmlNodata:'<p class="upwarp-nodata">-- END --</p>',inited:function(mescroll,upwarp){},showLoading:function(mescroll,upwarp){upwarp.innerHTML=mescroll.optUp.htmlLoading},showNoMore:function(mescroll,upwarp){upwarp.innerHTML=mescroll.optUp.htmlNodata},onScroll:null,scrollbar:{use:isPC,barClass:"mescroll-bar"},lazyLoad:{use:false,attr:"imgurl",showClass:"mescroll-lazy-in",delay:500,offset:200}})};MeScroll.extend=function(userOption,defaultOption){if(!userOption){return defaultOption}for(var key in defaultOption){if(userOption[key]==null){userOption[key]=defaultOption[key]}else{if(typeof userOption[key]==="object"){MeScroll.extend(userOption[key],defaultOption[key])}}}return userOption};MeScroll.prototype.initDownScroll=function(){var me=this;me.optDown=me.options.down||{};me.extendDownScroll(me.optDown);me.touchstartEvent=function(e){if(me.isScrollTo){me.preventDefault(e)}me.startPoint=me.getPoint(e);me.lastPoint=me.startPoint;me.maxTouchmoveY=me.getBodyHeight()-me.optDown.bottomOffset;me.inTouchend=false;var scrollTop=me.getScrollTop();me.isKeepTop=scrollTop===0;if(me.os.pc&&scrollTop<=0){me.scrollDom.addEventListener("mousemove",me.touchmoveEvent,{passive:false});document.ondragstart=function(){return false
}}};me.scrollDom.addEventListener("mousedown",me.touchstartEvent);me.scrollDom.addEventListener("touchstart",me.touchstartEvent);me.touchmoveEvent=function(e){if(!me.startPoint){return}var scrollTop=me.getScrollTop();if(scrollTop>0){me.isKeepTop=false}var curPoint=me.getPoint(e);var moveY=curPoint.y-me.startPoint.y;if(moveY>0){if(scrollTop<=0){me.preventDefault(e);if(me.optDown.use&&!me.inTouchend&&!me.isDownScrolling&&!me.optDown.isLock&&(!me.isUpScrolling||(me.isUpScrolling&&me.optUp.isBoth))){if(me.optDown.mustToTop&&!me.isKeepTop){return}var x=Math.abs(me.lastPoint.x-curPoint.x);var y=Math.abs(me.lastPoint.y-curPoint.y);var z=Math.sqrt(x*x+y*y);if(z!==0){var angle=Math.asin(y/z)/Math.PI*180;if(angle<me.optDown.minAngle){return}}if(me.maxTouchmoveY>0&&curPoint.y>=me.maxTouchmoveY){me.inTouchend=true;me.touchendEvent();return}var diff=curPoint.y-me.lastPoint.y;if(!me.downHight){me.downHight=0}if(me.downHight<me.optDown.offset){if(me.movetype!==1){me.movetype=1;me.optDown.inOffset(me);me.downwarp.classList.remove(me.optDown.resetClass);me.isMoveDown=true;if(me.os.ios&&!me.isKeepTop){me.scrollDom.classList.add(me.optDown.hardwareClass);me.scrollDom.style.webkitOverflowScrolling="auto";me.isSetScrollAuto=true}}me.downHight+=diff*me.optDown.inOffsetRate}else{if(me.movetype!==2){me.movetype=2;me.optDown.outOffset(me);me.downwarp.classList.remove(me.optDown.resetClass);me.isMoveDown=true;if(me.os.ios&&!me.isKeepTop){me.scrollDom.classList.add(me.optDown.hardwareClass);me.scrollDom.style.webkitOverflowScrolling="auto";me.isSetScrollAuto=true}}if(diff>0){me.downHight+=diff*me.optDown.outOffsetRate}else{me.downHight+=diff}}me.downwarp.style.height=me.downHight+"px";var rate=me.downHight/me.optDown.offset;me.optDown.onMoving(me,rate,me.downHight)}}}else{if(moveY<0){var scrollHeight=me.getScrollHeight();var clientHeight=me.getClientHeight();var toBottom=scrollHeight-clientHeight-scrollTop;if(!me.optUp.isBounce&&toBottom<=0){me.preventDefault(e)}if(me.optUp.use&&!me.optUp.isLock&&me.optUp.hasNext&&!me.isUpScrolling&&(!me.isDownScrolling||(me.isDownScrolling&&me.optDown.isBoth))&&(clientHeight+me.optUp.offset>=scrollHeight||toBottom<=0)){me.triggerUpScroll()}}}me.lastPoint=curPoint};me.scrollDom.addEventListener("touchmove",me.touchmoveEvent,{passive:false});me.touchendEvent=function(){if(me.optDown.use&&me.isMoveDown){if(me.downHight>=me.optDown.offset){me.triggerDownScroll()}else{me.downwarp.classList.add(me.optDown.resetClass);me.downHight=0;me.downwarp.style.height=0}if(me.isSetScrollAuto){me.scrollDom.style.webkitOverflowScrolling="touch";me.scrollDom.classList.remove(me.optDown.hardwareClass);me.isSetScrollAuto=false}me.movetype=0;me.isMoveDown=false}if(me.os.pc){me.scrollDom.removeEventListener("mousemove",me.touchmoveEvent);document.ondragstart=function(){return true}}};me.scrollDom.addEventListener("mouseup",me.touchendEvent);me.scrollDom.addEventListener("mouseleave",me.touchendEvent);me.scrollDom.addEventListener("touchend",me.touchendEvent);me.scrollDom.addEventListener("touchcancel",me.touchendEvent);if(me.optDown.use){me.downwarp=document.createElement("div");me.downwarp.className=me.optDown.warpClass;me.downwarp.innerHTML='<div class="downwarp-content">'+me.optDown.htmlContent+"</div>";var downparent=me.optDown.warpId?me.getDomById(me.optDown.warpId):me.scrollDom;if(me.optDown.warpId&&downparent){downparent.appendChild(me.downwarp)}else{if(!downparent){downparent=me.scrollDom}downparent.insertBefore(me.downwarp,me.scrollDom.firstChild)}setTimeout(function(){me.optDown.inited(me,me.downwarp)},0)}};MeScroll.prototype.preventDefault=function(e){if(e&&e.cancelable&&!e.defaultPrevented){e.preventDefault()}};MeScroll.prototype.getPoint=function(e){return{x:e.touches?e.touches[0].pageX:e.clientX,y:e.touches?e.touches[0].pageY:e.clientY}};MeScroll.prototype.triggerDownScroll=function(){if(!this.optDown.beforeLoading(this,this.downwarp)){this.showDownScroll();this.optDown.callback&&this.optDown.callback(this)}};MeScroll.prototype.showDownScroll=function(){this.isDownScrolling=true;this.optDown.showLoading(this);this.downHight=this.optDown.offset;this.downwarp.classList.add(this.optDown.resetClass);this.downwarp.style.height=this.optDown.offset+"px"};MeScroll.prototype.endDownScroll=function(){var me=this;var endScroll=function(){me.downHight=0;me.downwarp.style.height=0;me.isDownScrolling=false;if(me.downProgressDom){me.downProgressDom.classList.remove("mescroll-rotate")}};var delay=me.optDown.afterLoading(me);if(typeof delay==="number"&&delay>0){setTimeout(endScroll,delay)}else{endScroll()}};MeScroll.prototype.lockDownScroll=function(isLock){if(isLock==null){isLock=true}this.optDown.isLock=isLock};MeScroll.prototype.initUpScroll=function(){var me=this;me.optUp=me.options.up||{use:false};me.extendUpScroll(me.optUp);if(me.optUp.scrollbar.use){me.scrollDom.classList.add(me.optUp.scrollbar.barClass)}if(!me.optUp.isBounce){me.setBounce(false)}if(me.optUp.use===false){return}me.optUp.hasNext=true;me.upwarp=document.createElement("div");
me.upwarp.className=me.optUp.warpClass;var upparent;if(me.optUp.warpId){upparent=me.getDomById(me.optUp.warpId)}if(!upparent){upparent=me.scrollDom}upparent.appendChild(me.upwarp);me.preScrollY=0;me.lazyStartTime=new Date().getTime();me.lazyTag="mescroll-lazying";me.scrollEvent=function(){var scrollTop=me.getScrollTop();var isUp=scrollTop-me.preScrollY>0;me.preScrollY=scrollTop;if(!me.isUpScrolling&&(!me.isDownScrolling||(me.isDownScrolling&&me.optDown.isBoth))){if(!me.optUp.isLock&&me.optUp.hasNext){var toBottom=me.getScrollHeight()-me.getClientHeight()-scrollTop;if(toBottom<=me.optUp.offset&&isUp){me.triggerUpScroll()}}}var optTop=me.optUp.toTop;if(optTop.src||optTop.html){if(scrollTop>=optTop.offset){me.showTopBtn()}else{me.hideTopBtn()}}if(me.optUp.lazyLoad.use){var curTime=new Date().getTime();me.lazyTimer&&clearTimeout(me.lazyTimer);if(curTime-me.lazyStartTime>=me.optUp.lazyLoad.delay){me.lazyStartTime=curTime;me.lazyLoad(0)}else{me.lazyTimer=me.lazyLoad()}}me.optUp.onScroll&&me.optUp.onScroll(me,scrollTop,isUp)};if(me.isScrollBody){window.addEventListener("scroll",me.scrollEvent)}else{me.scrollDom.addEventListener("scroll",me.scrollEvent)}setTimeout(function(){me.optUp.inited(me,me.upwarp)},0)};MeScroll.prototype.setBounce=function(isBounce){if(this.isScrollBody||!this.os.ios){return}if(isBounce===false){this.optUp.isBounce=false;window.addEventListener("touchmove",this.bounceTouchmove,{passive:false})}else{this.optUp.isBounce=true;window.removeEventListener("touchmove",this.bounceTouchmove)}};MeScroll.prototype.bounceTouchmove=function(e){var me=this;var el=e.target;var isPrevent=true;while(el!==document.body&&el!==document){var cls=el.classList;if(cls){if(cls.contains("mescroll")||cls.contains("mescroll-touch")){isPrevent=false;break}else{if(cls.contains("mescroll-touch-x")||cls.contains("mescroll-touch-y")){var curX=e.touches?e.touches[0].pageX:e.clientX;var curY=e.touches?e.touches[0].pageY:e.clientY;if(!me.preWinX){me.preWinX=curX}if(!me.preWinY){me.preWinY=curY}var x=Math.abs(me.preWinX-curX);var y=Math.abs(me.preWinY-curY);var z=Math.sqrt(x*x+y*y);me.preWinX=curX;me.preWinY=curY;if(z!==0){var angle=Math.asin(y/z)/Math.PI*180;if((angle<=45&&cls.contains("mescroll-touch-x"))||(angle>45&&cls.contains("mescroll-touch-y"))){isPrevent=false;break}}}}}el=el.parentNode}if(isPrevent&&e.cancelable&&!e.defaultPrevented&&typeof e.preventDefault==="function"){e.preventDefault()}};MeScroll.prototype.triggerUpScroll=function(){if(this.optUp.callback&&!this.isUpScrolling){this.showUpScroll();this.optUp.page.num++;this.isUpAutoLoad=true;this.optUp.callback(this.optUp.page,this)}};MeScroll.prototype.showUpScroll=function(){this.isUpScrolling=true;this.upwarp.classList.add(this.optUp.hardwareClass);this.upwarp.style.visibility="visible";this.upwarp.style.display="block";this.optUp.showLoading(this,this.upwarp)};MeScroll.prototype.showNoMore=function(){this.upwarp.style.visibility="visible";this.upwarp.style.display="block";this.optUp.hasNext=false;this.optUp.showNoMore(this,this.upwarp)};MeScroll.prototype.hideUpScroll=function(displayAble){if(displayAble){this.upwarp.style.display="none"}else{this.upwarp.style.visibility="hidden"}this.upwarp.classList.remove(this.optUp.hardwareClass);var upProgressDom=this.upwarp.getElementsByClassName("upwarp-progress")[0];if(upProgressDom){upProgressDom.classList.remove("mescroll-rotate")}};MeScroll.prototype.endUpScroll=function(isShowNoMore,displayAble){if(isShowNoMore!=null){if(isShowNoMore){this.showNoMore()}else{this.hideUpScroll(displayAble)}}this.isUpScrolling=false};MeScroll.prototype.resetUpScroll=function(isShowLoading){if(this.optUp&&this.optUp.use){var page=this.optUp.page;this.prePageNum=page.num;this.prePageTime=page.time;page.num=1;page.time=null;if(!this.isDownScrolling&&isShowLoading!==false){if(isShowLoading==null){this.removeEmpty();this.clearDataList();this.showUpScroll()}else{this.showDownScroll()}}this.isUpAutoLoad=true;this.optUp.callback&&this.optUp.callback(page,this)}};MeScroll.prototype.setPageNum=function(num){this.optUp.page.num=num-1};MeScroll.prototype.setPageSize=function(size){this.optUp.page.size=size};MeScroll.prototype.clearDataList=function(){var listId=this.optUp.clearId||this.optUp.clearEmptyId;if(listId){var listDom=this.getDomById(listId);if(listDom){listDom.innerHTML=""}}};MeScroll.prototype.endByPage=function(dataSize,totalPage,systime){var hasNext;if(this.optUp.use&&totalPage!=null){hasNext=this.optUp.page.num<totalPage}this.endSuccess(dataSize,hasNext,systime)};MeScroll.prototype.endBySize=function(dataSize,totalSize,systime){var hasNext;if(this.optUp.use&&totalSize!=null){var loadSize=(this.optUp.page.num-1)*this.optUp.page.size+dataSize;hasNext=loadSize<totalSize}this.endSuccess(dataSize,hasNext,systime)};MeScroll.prototype.endSuccess=function(dataSize,hasNext,systime){var me=this;if(me.isDownScrolling){me.endDownScroll()}if(me.optUp.use){var isShowNoMore;if(dataSize!=null){var pageNum=me.optUp.page.num;var pageSize=me.optUp.page.size;
if(pageNum===1){me.clearDataList();if(systime){me.optUp.page.time=systime}}if(dataSize<pageSize||hasNext===false){me.optUp.hasNext=false;if(dataSize===0&&pageNum===1){isShowNoMore=false;me.showEmpty()}else{var allDataSize=(pageNum-1)*pageSize+dataSize;if(allDataSize<me.optUp.noMoreSize){isShowNoMore=false}else{isShowNoMore=true}me.removeEmpty()}}else{isShowNoMore=false;me.optUp.hasNext=true;me.removeEmpty()}}var displayAble=!me.optUp.hasNext;me.endUpScroll(isShowNoMore,displayAble);me.loadFull();me.optUp.lazyLoad.use&&me.lazyLoad(16)}};MeScroll.prototype.endErr=function(){if(this.isDownScrolling){var page=this.optUp.page;if(page&&this.prePageNum){page.num=this.prePageNum;page.time=this.prePageTime}this.endDownScroll()}if(this.isUpScrolling){this.optUp.page.num--;this.endUpScroll(false)}};MeScroll.prototype.loadFull=function(){var me=this;if(me.optUp.loadFull.use&&!me.optUp.isLock&&me.optUp.hasNext&&me.optUp.callback&&me.getScrollHeight()<=me.getClientHeight()){setTimeout(function(){if(me.getScrollHeight()<=me.getClientHeight()){me.triggerUpScroll()}},me.optUp.loadFull.delay)}};MeScroll.prototype.lockUpScroll=function(isLock){if(isLock==null){isLock=true}this.optUp.isLock=isLock};MeScroll.prototype.showEmpty=function(){var me=this;var optEmpty=me.optUp.empty;var warpId=optEmpty.warpId||me.optUp.clearEmptyId;if(warpId==null){return}var emptyWarp=me.getDomById(warpId);if(emptyWarp){me.removeEmpty();var str="";if(optEmpty.icon){str+='<img class="empty-icon" src="'+optEmpty.icon+'"/>'}if(optEmpty.tip){str+='<p class="empty-tip">'+optEmpty.tip+"</p>"}if(optEmpty.btntext){str+='<p class="empty-btn">'+optEmpty.btntext+"</p>"}me.emptyDom=document.createElement("div");me.emptyDom.className="mescroll-empty";me.emptyDom.innerHTML=str;emptyWarp.appendChild(me.emptyDom);if(optEmpty.btnClick){var emptyBtn=me.emptyDom.getElementsByClassName("empty-btn")[0];if(optEmpty.supportTap){emptyBtn.addEventListener("tap",function(e){e.stopPropagation();me.preventDefault(e);optEmpty.btnClick()})}else{emptyBtn.onclick=function(){optEmpty.btnClick()}}}}};MeScroll.prototype.removeEmpty=function(){this.removeChild(this.emptyDom)};MeScroll.prototype.showTopBtn=function(fadeDuration){if(!this.topBtnShow){this.topBtnShow=true;var me=this;var optTop=me.optUp.toTop;if(me.toTopBtn==null){if(optTop.html){me.toTopBtn=document.createElement("div");me.toTopBtn.innerHTML=optTop.html}else{me.toTopBtn=document.createElement("img");me.toTopBtn.src=optTop.src}me.toTopBtn.className=optTop.warpClass;if(optTop.supportTap){me.toTopBtn.addEventListener("tap",function(e){e.stopPropagation();me.preventDefault(e);var disToTop=optTop.btnClick&&optTop.btnClick();if(disToTop!==true){me.scrollTo(0,me.optUp.toTop.duration)}})}else{me.toTopBtn.onclick=function(){var disToTop=optTop.btnClick&&optTop.btnClick();if(disToTop!==true){me.scrollTo(0,me.optUp.toTop.duration)}}}var warpDom;if(optTop.warpId){warpDom=me.getDomById(optTop.warpId)}if(!warpDom){warpDom=document.body}warpDom.appendChild(me.toTopBtn)}me.toTopBtn.classList.remove(optTop.hideClass);me.toTopBtn.classList.add(optTop.showClass);me.setTopBtnFadeDuration(fadeDuration)}};MeScroll.prototype.hideTopBtn=function(fadeDuration){if(this.topBtnShow&&this.toTopBtn){this.topBtnShow=false;this.toTopBtn.classList.remove(this.optUp.toTop.showClass);this.toTopBtn.classList.add(this.optUp.toTop.hideClass);this.setTopBtnFadeDuration(fadeDuration)}};MeScroll.prototype.setTopBtnFadeDuration=function(fadeDuration){if(this.toTopBtn){var duration=(fadeDuration!=null?fadeDuration:this.optUp.toTop.fadeDuration)+"s";this.toTopBtn.style.animationDuration=duration;this.toTopBtn.style.webkitAnimationDuration=duration}};MeScroll.prototype.scrollTo=function(y,t){var me=this;var star=me.getScrollTop();var end=y;if(end>0){var maxY=me.getScrollHeight()-me.getClientHeight();if(end>maxY){end=maxY}}else{end=0}me.isScrollTo=true;me.scrollDom.style.webkitOverflowScrolling="auto";me.getStep(star,end,function(step){me.setScrollTop(step);if(step===end){me.scrollDom.style.webkitOverflowScrolling="touch";me.isScrollTo=false}},t)};MeScroll.prototype.getStep=function(star,end,callback,t,rate){var diff=end-star;if(t===0||diff===0){callback&&callback(end);return}t=t||300;rate=rate||30;var count=t/rate;var step=diff/count;var i=0;var timer=window.setInterval(function(){if(i<count-1){star+=step;callback&&callback(star,timer);i++}else{callback&&callback(end,timer);window.clearInterval(timer)}},rate)};MeScroll.prototype.lazyLoad=function(delay){var me=this;var t=delay!=null?delay:me.optUp.lazyLoad.delay;var timer=setTimeout(function(){var domArr=me.scrollDom.querySelectorAll("["+me.optUp.lazyLoad.attr+"]");var len=domArr.length;for(var i=0;i<len;i++){var dom=domArr[i];if(dom.getAttribute(me.lazyTag)!=="true"&&me.isInSee(dom,me.optUp.lazyLoad.offset)){var imgurl=dom.getAttribute(me.optUp.lazyLoad.attr);var temp=new Image();temp.onload=function(){var imgurl=this.src;var dom=this.dom;var showClass=me.optUp.lazyLoad.showClass;showClass&&dom.classList.add(showClass);
if(dom.tagName==="IMG"){dom.src=imgurl}else{dom.style.backgroundImage="url("+imgurl+")"}dom.removeAttribute(me.optUp.lazyLoad.attr);dom.removeAttribute(me.lazyTag)};temp.onerror=function(){this.dom.removeAttribute(me.lazyTag)};temp.onabort=function(){this.dom.removeAttribute(me.lazyTag)};temp.src=imgurl;dom.setAttribute(me.lazyTag,"true");temp.dom=dom}}},t);return timer};MeScroll.prototype.isInSee=function(dom,offset){offset=offset||0;var topDom=this.getOffsetTop(dom);var topSee=this.getScrollTop()-offset;var bottomDom=topDom+dom.offsetHeight;var bottomSee=topSee+offset+this.getClientHeight()+offset;return(topDom<bottomSee&&topDom>=topSee)||(bottomDom<=bottomSee&&bottomDom>topSee)};MeScroll.prototype.getOffsetTop=function(dom){var top=dom.offsetTop;var parent=dom.offsetParent;while(parent!=null&&parent!==this.scrollDom){top+=parent.offsetTop+parent.clientTop;parent=parent.offsetParent}return top};MeScroll.prototype.getScrollHeight=function(){return this.scrollDom.scrollHeight};MeScroll.prototype.getClientHeight=function(){if(this.isScrollBody&&document.compatMode==="CSS1Compat"){return document.documentElement.clientHeight}else{return this.scrollDom.clientHeight}};MeScroll.prototype.getBodyHeight=function(){return document.body.clientHeight||document.documentElement.clientHeight};MeScroll.prototype.getScrollTop=function(){if(this.isScrollBody){return document.documentElement.scrollTop||document.body.scrollTop}else{return this.scrollDom.scrollTop}};MeScroll.prototype.getToBottom=function(){return this.getScrollHeight()-this.getClientHeight()-this.getScrollTop()};MeScroll.prototype.setScrollTop=function(y){if(typeof y==="number"){if(this.isScrollBody){document.documentElement.scrollTop=y;document.body.scrollTop=y}else{this.scrollDom.scrollTop=y}}};MeScroll.prototype.getDomById=function(id){var dom;if(id){if(typeof id==="string"){dom=document.getElementById(id)}else{if(id.nodeType){dom=id}}}if(!dom){console.error('the element with id as "'+id+'" can not be found: document.getElementById("'+id+'")==null')}return dom};MeScroll.prototype.removeChild=function(dom){if(dom){var parent=dom.parentNode;parent&&parent.removeChild(dom);dom=null}};MeScroll.prototype.destroy=function(){var me=this;me.scrollDom.removeEventListener("touchstart",me.touchstartEvent);me.scrollDom.removeEventListener("touchmove",me.touchmoveEvent);me.scrollDom.removeEventListener("touchend",me.touchendEvent);me.scrollDom.removeEventListener("touchcancel",me.touchendEvent);me.scrollDom.removeEventListener("mousedown",me.touchstartEvent);me.scrollDom.removeEventListener("mousemove",me.touchmoveEvent);me.scrollDom.removeEventListener("mouseup",me.touchendEvent);me.scrollDom.removeEventListener("mouseleave",me.touchendEvent);me.removeChild(me.downwarp);if(me.isScrollBody){window.removeEventListener("scroll",me.scrollEvent)}else{me.scrollDom.removeEventListener("scroll",me.scrollEvent)}me.removeChild(me.upwarp);me.removeChild(me.toTopBtn);me.setBounce(true)};return MeScroll});
